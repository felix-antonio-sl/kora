# KODA KB: Data Access Layers via Category Theory
_manifest:
  urn: "urn:kora:cat:data-access-layers:1.0.0"
  federation: { visibility: internal, license: "CC-BY-4.0" }
  provenance: { created_by: FS, created_at: "2025-12-08" }

LLM_Parsing_Instructions:
  ID: KODA-LLM-PARSER-01
  Req: Mandatory block following Metadata.
  Prohib: Using for artifact creation or translation.
  Content: |
    BEGIN_LLM_INSTRUCTIONS
    You are an AI agent consuming a KODA artifact. Parse with absolute fidelity.

    FIDELITY: Preserve meat (essential information) and skeleton (structure: headers, IDs, lists, tables) with zero loss. Ignore fat (filler words, rhetoric, stylistic prose).

    LEXICON (expand before processing): Act->Action, Cond->Condition, Ctx->Context, Ctx_Required->Required External Reference, Ctx_Optional->Optional External Reference, Def->Definition, Ex->Example, Mssn->Mission, Obj->Objective, Proc->Process, Purp->Purpose, Ref->Reference, XRef->Cross-Artifact Reference, XRef_Required->Mandatory Cross-Artifact Reference, Req->Requirement, Res->Result, Src->Source, Prohib->Prohibition, Warn->Warning, Just->Justification, Rec->Recommendation

    REFERENCE POLICY: Ref: is internal only—must point to existing ID within THIS document. XRef/XRef_Required: are external only—must point to a URN (optionally with #ID fragment) in another artifact. External documents without specific ID use Ctx:, Ctx_Required:, or Ctx_Optional:.

    LANGUAGE POLICY: Keywords in English, content in original language. Never translate content.
    END_LLM_INSTRUCTIONS

ID: CAT-DAL-01
Version: 1.0.0
Status: Draft
Human-Creator: FS
Model-Collaborator: Cascade
Creation-Date: 2025-12-08
Modification-Date: 2025-12-14
Version-Notes: "Cheatsheet compacto de patrones categóricos para Data Access Layers."
Ctx: "Patrones categóricos para DAL: storage, APIs, repos, ORMs, lakes."

Storage:
  - {
      id: LIMITS-SQL,
      def: "SQL=límites (product,pullback,equalizer)",
      use: "integridad,JOINs,ACID",
    }
  - {
      id: COLIMITS-NOSQL,
      def: "NoSQL=colímites (coproduct,pushout)",
      use: "flex schema,polyglot",
    }
  - { id: MIXED-LENS, def: "SQL(write)↔Doc(read) via lens asimétrico" }

APIs:
  - {
      id: REST,
      functor: "Domain→ResourceCat",
      check: "F(id)=id,F(g∘f)=F(g)∘F(f)",
    }
  - { id: GRAPHQL, functor: "Domain→TypeCat", feature: "pullback dinámico" }
  - { id: GRPC, functor: "Domain→ProtoCat", use: "streaming,microservicios" }
  - { id: STREAMS, nature: "Coalgebra", principle: "acción=pk" }

Repository:
  structure: "Coalgebra c:X→F(X)"
  bisim: "R₁~R₂ ⟺ ∀ops.observe(R₁(ops))=observe(R₂(ops))"

ORM:
  structure: "Adjunción ORM⊣Reflect: DomainCat⇆SchemaCat"
  unit: "η:E→Reflect(ORM(E))≈id"
  counit: "ε:ORM(Reflect(T))→T≈id"
  drift: "violación η/ε=drift"

DataLake:
  construction: "colim(Dataset_i,Pipeline_ij)"
  grothendieck: "∫F, I=zonas, F(z)=schema_z"
  audit: "pipelines=morfismos; diagrama conmuta"

Synthesis:
  model: "2-cat: obj=componentes, 1-morph=transformaciones, 2-morph=migraciones"
  audit_dims:
    [
      STORAGE-MODEL-ALIGN,
      API-FUNCTOR-PRESERVE,
      REPO-BISIM,
      ORM-ADJ-VALID,
      PIPELINE-COMMUTE,
    ]
