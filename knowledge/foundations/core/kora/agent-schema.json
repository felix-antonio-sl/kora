{
  "_deprecated": {
    "status": "deprecated",
    "replaced_by": "urn:kora:kb:agent-spec-md",
    "note": "KORA 4.0 abandona JSON Schema monolÃ­tico. Ver agent-spec-md.md."
  },
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "urn:kora:kb:agent-schema:2.0.0",
  "title": "KORA Agent Protocol Schema v2.0",
  "description": "Radically simplified JSON Schema for KORA agent FSM architecture.",
  "type": "object",
  "required": [
    "_manifest",
    "KORA_Runtime_Instructions",
    "agent_identity_and_global_configuration",
    "knowledge_base_interaction_and_governance_rules",
    "public_behavior_workflows_and_states",
    "private_internal_reasoning_processes",
    "input_output_style_format_and_interaction",
    "safety_constraints_and_behavioral_guardrails",
    "self_evaluation_and_correction_mechanisms"
  ],
  "properties": {
    "_manifest": {
      "type": "object",
      "required": ["urn"],
      "properties": {
        "urn": {
          "type": "string",
          "pattern": "^urn:[a-z0-9-]+:agent:[a-z0-9-]+:(?:\\d+\\.\\d+\\.\\d+|latest|stable)$",
          "description": "KORA 2.0 Canonical URN Format (e.g. urn:kora:agent:arquitecto:1.0.0)"
        }
      }
    },
    "KORA_Runtime_Instructions": {
      "type": "object",
      "required": ["Activation", "Content"],
      "properties": {
        "Activation": { "type": "string" },
        "Content": {
          "type": "string",
          "pattern": "BEGIN_KORA_RUNTIME[\\s\\S]*END_KORA_RUNTIME"
        }
      }
    },
    "agent_identity_and_global_configuration": {
      "type": "object",
      "required": ["primary_role_objective_and_audience", "settings"],
      "properties": {
        "primary_role_objective_and_audience": {
          "type": "object",
          "required": ["role", "objective", "audience"]
        },
        "settings": {
          "type": "object",
          "required": ["content_lang"]
        }
      }
    },
    "knowledge_base_interaction_and_governance_rules": {
      "type": "object",
      "required": ["policy"],
      "properties": {
        "policy": {
          "type": "string",
          "enum": ["EXCLUSIVE_USE", "ALLOW_GENERAL_KNOWLEDGE", "LLM_NATIVE", "WEB_AUGMENTED", "HYBRID_WEB_KB"]
        },
        "source_artifacts": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^urn:[a-z0-9-]+:(kb|skill|ref|sys|doc|tool):[a-z0-9-]+:(?:\\d+\\.\\d+\\.\\d+|latest|stable)$"
          }
        },
        "uncertainty_protocol": { "type": "string" },
        "citation_formatting": { "type": "object" },
        "web_search_configuration": { "type": "object" }
      }
    },
    "public_behavior_workflows_and_states": {
      "type": "object",
      "required": ["defined_workflows", "defined_states"],
      "properties": {
        "defined_workflows": {
          "type": "object",
          "patternProperties": {
            "^WF-[A-Z0-9-]+$": {
              "type": "object",
              "required": ["initial_state"]
            }
          }
        },
        "defined_states": {
          "type": "object",
          "patternProperties": {
            "^S-[A-Z0-9-]+$": {
              "type": "object",
              "required": ["role", "process", "transitions"],
              "properties": {
                "process": {
                  "type": "array",
                  "maxItems": 5
                },
                "transitions": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "pattern": "^IF .+ -> S-[A-Z0-9-]+$"
                  }
                }
              }
            }
          }
        }
      }
    },
    "private_internal_reasoning_processes": {
      "type": "object",
      "patternProperties": {
        "^CM-[A-Z0-9-]+$": {
          "type": "object",
          "required": ["_meta"],
          "properties": {
            "_meta": {
              "type": "object",
              "required": ["expose"],
              "properties": {
                "expose": { "const": false }
              }
            }
          }
        }
      }
    },
    "input_output_style_format_and_interaction": { "type": "object" },
    "safety_constraints_and_behavioral_guardrails": { "type": "object" },
    "self_evaluation_and_correction_mechanisms": { "type": "object" },
    "orchestration_fleet_and_protocol": { "type": "object" }
  }
}
